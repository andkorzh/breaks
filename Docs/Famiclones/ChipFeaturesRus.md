# Особенности чипов фамиклонов

В данном разделе находится описание отличительных особенностей (которые иногда являются по сути багами) известных фамиклон-чипов.

## Историческая справка

Изучая какие фабрики по производству чипов существовали в начале 90-х на территории Китая/Тайваня, можно выдвинуть следующую гипотезу:

- Чипы с маркировкой UM производились на фабриках UMC (это очевидно, т.к. на чипах есть маркировки)
- Чипы с маркировками "MG" - это перемаркированные чипы UMC
- Чипы с маркировками "HA" не исследованы
- Чипы с маркировкой TA/T/1818 предположительно производились на фабрике TSMC Fab1 (https://anysilicon.com/history-and-milestones-of-tsmc/). Другой фабрики на букву "T" не обнаруживается. У данных чипов топологическая маска отличается от чипов UMC.

https://en.wikipedia.org/wiki/List_of_semiconductor_fabrication_plants

Изначально CPU/PPU были раздельными чипами. Потом они стали двигаться в сторону интеграции: вначале появились NOAC без встроенной памяти, а затем и память WRAM/VRAM переехала внутрь NOAC.

## Сводная таблица

|Ревизия чипа|Производитель|Год|Тип|Отличительные особенности|
|---|---|---|---|---|
|UA6527	|UMC	|no	|CPU	|скважность 25% и 50% на обоих square перепутана местами. Яркая АЧХ, сочнее бас и вч по сравнению с оригиналами.|
|UA6528	|UMC	|no	|PPU	|неизвестно|
|UA6540	|UMC	|no	|CPU	|скважность 25% и 50% на обоих square перепутана местами. Яркая АЧХ, сочнее бас и вч по сравнению с оригиналами..|
|UA6541	|UMC	|no	|PPU	|Red/Green эмфаза-биты перепутаны местами как в официальном 2С07. Уровни выходных сигналов поярче официальных PAL|
|UA6527P	|UMC	|no	|CPU	|скважность 25% и 50% на обоих square перепутана местами. Яркая АЧХ, сочнее бас и вч по сравнению с оригиналами..|
|UA6538	|UMC	|no	|PPU	|Red/Green эмфаза-биты перепутаны местами как в официальном 2С07. Уровни выходных сигналов поярче официальных PAL|
|UM6561	Семейство. F - в корпусах. H и T - в каплях|||||
|UM6561F-1	|UMC	|no	|FullNOAC	|Скважность ОК. Triangle пощёлкивает. Эмфаза-биты ярче, чем нужно (насчет попутанности неизвестно), соответственно затемняют сильнее, когда вкл. все три|
|UM6561AF-1	|UMC	|no	|FullNOAC	|Принц персии дико глючит. Остальное как в F и требует дальнейшего изучения.|
|UM6561BF-1	|UMC	|no	|FullNOAC	|неизвестно.  На форумах пишут, что добавились проблемы с DPCM, инфа непроверена|
|UM6561CF-1	|UMC	|no	|FullNOAC	|неизвестно.  На форумах пишут, что добавились проблемы с DPCM, инфа непроверена|
|UM6561F-2	|UMC	|no	|FullNOAC	|Скважность ОК. Triangle пощёлкивает. Эмфаза-биты также попутаны и ярче, чем нужно, соответственно затемняют сильнее, когда вкл. все три|
|UM6561AF-2	|UMC	|no	|FullNOAC	|Принц персии дико глючит. Остальное как в F и требует дальнейшего изучения.|
|UM6561BF-2	|UMC	|no	|FullNOAC	|неизвестно.  На форумах пишут, что добавились проблемы с DPCM, инфа непроверена|
|UM6561CF-2	|UMC	|no	|FullNOAC	|неизвестно.  На форумах пишут, что добавились проблемы с DPCM, инфа непроверена|
|UM6561H	|UMC	|no	|FullNOAC	|Капли неизучены. Некоторые из них могут переключаться между NTSC и Dendy при замене кварца и манипуляциях с выводами|
|UM6561BH	|UMC	|no	|FullNOAC	|Капли неизучены. Некоторые из них могут переключаться между NTSC и Dendy при замене кварца и манипуляциях с выводами|
|UM6561T	|UMC	|no	|FullNOAC	|Капли неизучены. Некоторые из них могут переключаться между NTSC и Dendy при замене кварца и манипуляциях с выводами|
|T|||||
|T1818P	|unknown	|no	|PartialNOAC	|Частичный Nes-On-A-Chip (NoAC), требует 2кб+2кб внешней ОЗУ. Скважность перепутана, эмфаза перепутана и темнее. Треугольник щелкает. АЧХ говно, бас завален, даже если обойти внутренний ОУ|
|1818P	|unknown	|no	|PartialNOAC	|отличия между 1818Р и Т1818Р неизвестны|
|TA|||||
|TA-03NP1 6527P	|TA	|no	|CPU	|Скважность ОК. DPCM попадается проблемный в зависимости от экземпляра. АЧХ похуже чем у UA6527х, но в целом норм чип.|
|TA-02NP 6538	|TA	|no	|PPU	|Эмфаза-биты перепутаны как во всех остальных PAL и Dendy, но НЕ перебущены как в большинстве NOACов . Уровни сигнала ниже чем у UA65хх, и ближе к официальному|
|TA-03N	|TA	|no	|CPU	|неизвестно|
|TA-02N	|TA	|no	|PPU	|неизвестно|
|TA-02NPB	|TA	|no	|PPU	|неизвестно|
|TA-02NPB1	|TA	|no	|PPU	|неизвестно|
|MG|||||	
|MG-P-501	|MicroGenius	|no	|CPU|См. UA6527P: при визуальных, звуковых и органолептических тестах - все то же самое|
|MG-P-502	|MicroGenius	|no	|PPU|См. UA6538: при визуальных, звуковых и органолептических тестах - все то же самое|
|HA|||||
|HA6527P	|Haili?	|no	|CPU	|См. UA6527P: при визуальных, звуковых и органолептических тестах - все то же самое|
|HA6538	|Haili?	|no	|PPU	|См. UA6538: при визуальных, звуковых и органолептических тестах - все то же самое|

Credits: @eugene-nes

## Особенности чипов

Под "фичей" имеется ввиду какое-то уникальное для фамиклон-чипа решение, зачастую по сути являющееся багом. Там где APU и PPU объединены в NoAC соответственно можно говорить что указанные фичи - это особенности чипа NoAC в целом

Список известных особенностей чипов APU:
- Частота главного кварца
- Коэффициент делителя CLK
- Некорректный декодер DPCM
- Перепутанная скважность прямоугольного канала
- Щёлкающий генератор треугольного канала
- Некорректная работа генератора шума, скорее всего связанная с соотв. декодером
- Неотключенная схема BCD коррекции АЛУ ядра 6502
- Отладочные регистры (2A03), pin30
- Поддержка останова ядра 6502 (2C07), pin30

Список известных особенностей чипов PPU:
- Частота главного кварца (если для PPU используется отдельный кварц)
- Делитель PCLK по подобию 2C02 (NTSC PPU)
- Делитель PCLK по подобию 2C07 (PAL PPU)
- H/V декодер по подобию 2C02 (NTSC PPU)
- H/V декодер по подобию 2C07 (PAL PPU)
- Необычный H/V декодер с затянутым VBlank (UMC)
- Необычный H/V декодер, ещё неисследованный (TA)
- Расширенный декодер Chroma для поддержки фазовой альтерации (2C07)
- Задержка сигнала #PICTURE (2C07)
- Задержка сигнала BLACK (Rendering Disabled) (2C07)
- Специальная обработка сигнала BLNK в OAM Eval (2C07)
- Задержка записи в $2003 (2C07)
- Перепутанные биты Emphasis (2С07)
- ЦАП по подобию Ricoh PPU
- ЦАП собственной топологии (TA)
- ЦАП с завышенной насыщенностью (скорее всего из-за неверных расчётов в площади чипа) (UMC)

Более подробное сравнение схем соответствующих чипов смотри в разделах APU/PPU на Wiki.

Также см.:
- https://www.nesdev.org/wiki/CPU_variants
- https://www.nesdev.org/wiki/PPU_variants
- https://forums.nesdev.org/viewtopic.php?t=23916
