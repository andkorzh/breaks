# Звуковые генераторы

APU содержит следующие каналы звука (официальные обозначения):
- Sound A: Тональный генератор прямоугольных импульсов (Square 0)
- Sound B: Тональный генератор прямоугольных импульсов (Square 1)
- Sound C: Тональный генератор треугольного сигнала
- Sound D: Генератор шума
- Sound E: Канал для воспроизведения сэмплов, используя дельта-модуляцию (имеется также возможность прямого воспроизведения PCM сэмплов)

Все схемы для генерации звука по большей части представляют собой различные счётчики, управляемые простыми схемами контроля.

![SoundGenerators](/BreakingNESWiki/imgstore/apu/SoundGenerators.jpg)

(На схеме кроме непосредственно звуковых генераторов также представлена OAM DMA, так как она тесно взаимодействует с DPCM DMA).

## Тайминг

Звуковые генераторы тактируются следующими сигналами:
- PHI1/2: Тактовая частота CPU Core
- ACLK: Audio CLK. В два раза замедленная PHI, с неперекрывающимся фазовым паттерном
- LFO1/2: Сигналы низкочастотной осцилляции (порядка сотен Герц)

Разработчики решили использовать для треугольного канала PHI1 вместо ACLK, чтобы сгладить "ступенчатость" сигнала.

## Sweep

Sweep - это константное по времени увеличение или уменьшение частоты сигнала (периода). Влияет на pitch (тональность).

Термин `Sweep` не переводится на русский язык. В музыке есть аналогичный приём, называемый [глиссандо](https://ru.wikipedia.org/wiki/%D0%93%D0%BB%D0%B8%D1%81%D1%81%D0%B0%D0%BD%D0%B4%D0%BE).

В APU используется только в прямоугольных каналах.

![wave_sweep](/BreakingNESWiki/imgstore/apu/wave_sweep.png)

## Envelope

Envelope - это константное затухание амплитуды сигнала (в применении к звуковым генераторам APU).

Envelope является частным случаем ADSR-огибающей, а конкретно является компонентом Decay (спад или затухание).

В APU используется в прямоугольных каналах и генераторе шума.

![wave_envelope](/BreakingNESWiki/imgstore/apu/wave_envelope.png)

## Duty

Duty - это изменение скважности прямоугольного сигнала.

В APU используется только в прямоугольных каналах.

![wave_duty](/BreakingNESWiki/imgstore/apu/wave_duty.png)
