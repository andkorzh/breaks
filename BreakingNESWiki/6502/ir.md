# Регистр инструкций

![6502_locator_ir](/BreakingNESWiki/imgstore/6502/6502_locator_ir.jpg)

Регистр инструкций (IR) хранит текущий код операции, для обработки на [декодере](decoder.md). Код операции загружается в IR с [логики предекодирования](predecode.md).

## Транзисторная схема

![ir_tran](/BreakingNESWiki/imgstore/ir_tran.jpg)

Выходы на схеме слева, потому что с левой стороны топологически расположен декодер.

- IR0 и IR1 для экономии линий объединяются в одну общую линию `IR01`.
- IR0 используется только для 128й линии декодера (IMPL) (данная операция с IR0 является частью рандомной логики)
- /IR5 дополнительно идёт на флаги и используется в инструкциях установки/сброса флагов (SEI/CLI, SED/CLD, SEC/CLC)

## Логическая схема

![ir_logic](/BreakingNESWiki/imgstore/ir_logic.jpg)

- Во время PHI1 значение IR перегружается с защелки [Predecode (PD)](predecode.md), но только если активна команда `FETCH`
- Во время PHI2 IR "рефрешится"  (это не отображается на логической схеме)

Необходимо отметить, что на вход IR подается инвертированное значение кода операции (PD) и хранится оно на защелке также в инвертированном виде.
